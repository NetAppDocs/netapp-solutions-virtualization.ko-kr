---
sidebar: sidebar 
permalink: proxmox/proxmox-ontap-nvme-fc.html 
keywords: netapp, proxmox, proxmox ve, nvme, nvme-fc, lvm, ontap, storage 
summary: 'ONTAP 사용하여 Proxmox 가상 환경에 Fibre Channel을 통한 NVMe로 논리 볼륨 관리자(LVM)를 구성합니다. 이 절차에는 nvme-cli 설치, 네임스페이스 프로비저닝, 서브시스템 설정 및 공유 스토리지용 볼륨 그룹 생성이 포함됩니다.' 
---
= Proxmox VE용 NVMe/FC를 사용하여 LVM 구성
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
NetApp ONTAP 사용하여 Fibre Channel 프로토콜을 통해 NVMe를 이용해 Proxmox 가상 환경(VE) 호스트 간 공유 스토리지를 위한 논리 볼륨 관리자(LVM)를 구성합니다. 이 구성은 최신 NVMe 프로토콜을 사용하여 낮은 지연 시간으로 고성능 블록 수준 스토리지 액세스를 제공합니다.



== 초기 가상화 관리자 작업

Proxmox VE 호스트를 NVMe/FC 연결에 맞게 준비하고 스토리지 관리자에게 필요한 정보를 수집하려면 다음 초기 작업을 완료하십시오.

. 두 개의 HBA 인터페이스가 사용 가능한지 확인하십시오.
. 클러스터의 모든 Proxmox 호스트에서 다음 명령을 실행하여 WWPN 정보를 수집하고 nvme-cli 패키지가 설치되었는지 확인하십시오.
+
[source, shell]
----
apt update
apt install nvme-cli
cat /sys/class/fc_host/host*/port_name
nvme show-hostnqn
----
. 수집한 호스트 NQN 및 WWPN 정보를 스토리지 관리자에게 제공하고 필요한 크기의 NVMe 네임스페이스를 요청하십시오.




== 스토리지 관리자 작업

ONTAP 처음 사용하시는 경우, 시스템 관리자를 이용하시면 더욱 편리하게 사용하실 수 있습니다.

. SVM이 NVMe 프로토콜이 활성화된 상태로 사용 가능한지 확인하십시오. 참조하다 link:https://docs.netapp.com/us-en/ontap/san-admin/create-nvme-namespace-subsystem-task.html["ONTAP 9 문서의 NVMe 작업"].
. NVMe 네임스페이스를 생성합니다.
+
.예를 보여주세요
[%collapsible]
====
image:proxmox-ontap-nvme-fc-001.png["nvme 네임스페이스 생성"]

====
. (CLI를 사용하는 경우) 서브시스템을 생성하고 호스트 NQN을 할당합니다. 위의 참조 링크를 따라가세요.
. 보안 탭에서 랜섬웨어 방지 기능이 활성화되어 있는지 확인하십시오.
+
.예를 보여주세요
[%collapsible]
====
image:proxmox-ontap-nvme-fc-002.png["랜섬웨어 방지 상태"]

====
. 가상화 관리자에게 NVMe 네임스페이스가 생성되었음을 알리십시오.




== 가상화 관리자 최종 작업

Proxmox VE에서 NVMe 네임스페이스를 공유 LVM 스토리지로 구성하려면 다음 작업을 완료하십시오.

. 클러스터에 있는 각 Proxmox VE 호스트에서 셸에 접속하여 새 네임스페이스가 표시되는지 확인하십시오.
. 네임스페이스 세부 정보를 확인하세요.
+
[source, shell]
----
nvme list
----
. 장치 세부 정보를 검사하고 수집합니다.
+
[source, shell]
----
nvme list
nvme netapp ontapdevices
nvme list-subsys
lsblk -N
----
. 볼륨 그룹을 생성합니다.
+
[source, shell]
----
vgcreate <volume group name> /dev/mapper/<device id>
# Where <volume group name> is the desired name for the volume group and <device id> is the nvme device id.
pvs
# Verify the physical volume is part of the volume group.
vgs
# Verify the volume group is created.
----
. 관리 UI를 사용하여 `https:<proxmox node>:8006`데이터센터를 클릭하고 스토리지를 선택한 다음 추가를 클릭하고 LVM을 선택합니다.
+
.예를 보여주세요
[%collapsible]
====
image:proxmox-ontap-nvme-fc-003.png["LVM 스토리지 탐색"]

====
. 스토리지 ID 이름을 입력하고, 기존 볼륨 그룹을 선택한 다음, CLI를 사용하여 방금 생성한 볼륨 그룹을 선택하십시오. 공유 옵션을 선택하세요. Proxmox VE 9 이상 버전에서는 다음을 활성화하십시오. `Allow Snapshots as Volume-Chain` 고급 확인란을 활성화하면 표시되는 옵션입니다.
+
.예를 보여주세요
[%collapsible]
====
image:proxmox-ontap-nvme-fc-004.png["기존 vg에 lvm 설치"]

====
. 다음은 NVMe/FC를 사용하는 LVM용 스토리지 구성 파일의 예입니다.
+
.예를 보여주세요
[%collapsible]
====
image:proxmox-ontap-nvme-fc-005.png["NVMe FC 구성의 LVM"]

====

