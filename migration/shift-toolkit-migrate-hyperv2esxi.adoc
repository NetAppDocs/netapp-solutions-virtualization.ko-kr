---
sidebar: sidebar 
permalink: migration/shift-toolkit-migrate-hyperv2esxi.html 
keywords: netapp, vmware, esxi, vm, migration, virtualization, hyper-v, microsoft 
summary: Shift Toolkit을 사용하여 소스 및 대상 사이트를 구성하고, 리소스 그룹과 블루프린트를 만들고, 마이그레이션 워크플로를 실행하여 Microsoft Hyper-V에서 VMware ESXi로 VM을 마이그레이션합니다. 
---
= Shift Toolkit을 사용하여 Microsoft Hyper-V에서 VMware ESXi로 VM 마이그레이션
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Shift Toolkit을 사용하여 소스 및 대상 사이트를 구성하고, 리소스 그룹과 블루프린트를 만들고, 마이그레이션 워크플로를 실행하여 Microsoft Hyper-V에서 VMware ESXi로 VM을 마이그레이션합니다.

Shift Toolkit을 사용하면 추가 디스크 사본을 생성하지 않고도 하이퍼바이저 간에 직접 VM을 변환할 수 있으므로 Windows 및 Linux 가상 머신 모두에서 최소한의 다운타임으로 사본 없는 마이그레이션이 가능합니다.



== 시작하기 전에

마이그레이션을 시작하기 전에 다음 전제 조건이 충족되는지 확인하세요.

.VMware 요구 사항
* vCenter 및 ESXi 호스트가 구성되었습니다.
* 최소 필수 권한이 있는 vCenter 서버 계정(RBAC 사용자)
* vCenter 및 ESXi 호스트는 Shift Toolkit에서 접근 가능하며 DNS 항목은 최신 상태입니다.
* 분산 포트 그룹은 적절한 VLAN ID로 구성됩니다(표준 포트 그룹은 지원되지 않음)
* NFS 공유(마이그레이션된 VM 저장용) 및 소스 공유(마이그레이션될 VM용)는 동일한 볼륨에 있습니다.


.Hyper-V 요구 사항
* VM VHDx 파일은 SMB 공유에 배치됩니다.
+
** VM이 CSV(클러스터 공유 볼륨)에 있는 경우 SMB 공유로 라이브 마이그레이션을 수행합니다.


* Hyper-V 통합 서비스가 활성화되어 게스트 VM에서 실행 중입니다.
* 마이그레이션할 VM은 준비를 위해 RUNNING 상태입니다.
* 마이그레이션을 트리거하기 전에 VM의 전원을 꺼야 합니다.


.게스트 VM 요구 사항
* Windows VM의 경우: VM의 기존 사용자 프로필과 함께 로컬 관리자 자격 증명 또는 도메인 자격 증명을 사용합니다.
* Linux VM의 경우: 암호 입력 없이 sudo 명령을 실행할 수 있는 권한이 있는 사용자를 사용하세요.
* Shift Toolkit은 Windows VM의 경우 PowerShell Direct를 사용하고 Linux VM의 경우 SSH를 사용합니다.




== 1단계: 소스 사이트 추가(Hyper-V)

Shift Toolkit에 소스 Hyper-V 환경을 추가합니다.

.단계
. 지원되는 브라우저에서 Shift Toolkit을 열고 기본 자격 증명으로 로그인합니다.
. *검색 > 사이트 추가*로 이동합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-350.png[사이트 추가 메뉴]

====
. *새 사이트 추가*를 클릭하고 *소스*를 선택합니다.
. 출처 사이트 세부 정보를 입력하세요.
+
** *사이트 이름*: 사이트 이름을 입력하세요
** *하이퍼바이저*: Hyper-V를 선택하세요
** *사이트 위치*: 기본 옵션을 선택하세요
** *커넥터*: 기본 선택을 선택하세요


. *계속*을 클릭하세요.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-351.png[출처 사이트 세부 정보]

====
. Hyper-V 세부 정보를 입력하세요.
+
** *Hyper-V 독립 실행형 또는 장애 조치 클러스터 관리자*: IP 주소 또는 FQDN
** *사용자 이름*: UPN 형식의 사용자 이름(username@domain.com 또는 domain\administrator)
** *비밀번호*: Hyper-V 호스트 또는 FCI 인스턴스에 액세스하기 위한 비밀번호


. *계속*을 클릭하세요.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-352.png[Hyper-V 자격 증명]

====
+

NOTE: Hyper-V FCI 및 호스트 검색은 DNS 확인에 의존합니다. 해결에 실패하면 호스트 파일(C:\Windows\System32\drivers\etc\hosts)을 업데이트하고 검색 작업을 다시 시도하세요.

. ONTAP 스토리지 시스템 자격 증명을 입력하세요.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-353.png[ONTAP 자격 증명]

====
. *사이트 만들기*를 클릭하세요.


.결과
Shift Toolkit은 자동 검색을 수행하고 네트워크, 가상 스위치, VLAN ID를 포함한 메타데이터 정보와 함께 VM을 표시합니다.

.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-354.png[발견 결과]

====

NOTE: VM 인벤토리는 24시간마다 자동으로 새로 고쳐집니다.  수정 후 수동으로 새로 고침하려면 사이트 이름 옆에 있는 세 개의 점을 클릭하고 *사이트 검색*을 선택하세요.



== 2단계: 대상 사이트 추가(VMware ESXi)

Shift Toolkit에 대상 VMware 환경을 추가합니다.

.단계
. *새 사이트 추가*를 클릭하고 *대상*을 선택하세요.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-357.png[목적지 사이트 추가]

====
. 목적지 사이트 세부 정보를 입력하세요:
+
** *사이트 이름*: 사이트 이름을 입력하세요
** *하이퍼바이저*: VMware 선택
** *사이트 위치*: 기본 옵션을 선택하세요
** *커넥터*: 기본 선택을 선택하세요


. *계속*을 클릭하세요.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-358.png[목적지 사이트 세부 정보]

====
. VMware vCenter 세부 정보를 입력하세요.
+
** *엔드포인트*: vCenter 서버의 IP 주소 또는 FQDN
** *사용자 이름*: UPN 형식의 사용자 이름(username@domain.com)
** *vCenter 비밀번호*: vCenter에 액세스하기 위한 비밀번호
** *vCenter SSL 지문* (선택 사항)


. *자체 서명된 인증서 수락*을 선택하고 *계속*을 클릭합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-359.png[vCenter 자격 증명]

====
. *사이트 만들기*를 클릭하세요.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-360.png[사이트 생성 확인]

====
+

NOTE: 디스크 포맷 변환은 동일한 볼륨 내의 볼륨 수준에서 발생하므로 소스 및 대상 저장 시스템은 동일해야 합니다.





== 3단계: 리소스 그룹 만들기

부팅 순서와 부팅 지연 구성을 보존하기 위해 VM을 리소스 그룹으로 구성합니다.

.시작하기 전에
필수 구성 요소에 지정된 대로 qtree가 프로비저닝되었는지 확인하세요.

.단계
. *리소스 그룹*으로 이동하여 *새 리소스 그룹 만들기*를 클릭합니다.
. 드롭다운에서 소스 사이트를 선택하고 *만들기*를 클릭합니다.
. 리소스 그룹 세부 정보를 제공하고 워크플로를 선택합니다.
+
** *복제 기반 마이그레이션*: 소스 하이퍼바이저에서 대상 하이퍼바이저로 종단 간 마이그레이션을 수행합니다.
** *클론 기반 변환*: 디스크 형식을 선택한 하이퍼바이저 유형으로 변환합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-361.png[리소스 그룹 워크플로]

====


. *계속*을 클릭하세요.
. 검색 옵션을 사용하여 VM을 선택합니다(기본 필터는 "데이터 저장소"입니다).
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-362.png[VM 선택]

====
+

NOTE: 변환하기 전에 새로 생성된 ONTAP SVM의 지정된 SMB 공유로 VM을 이동하여 스테이징 영역에서 프로덕션 공유를 격리합니다.  데이터 저장소 드롭다운에는 SMB 공유만 표시되고 CSV는 표시되지 않습니다.

+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-363.png[데이터 저장소 선택]

====
. 마이그레이션 세부 정보 업데이트:
+
** *목적지* 선택
** *대상 VMware 항목*을 선택하세요
** 볼륨을 Qtree 매핑으로 구성
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-364.png[마이그레이션 세부 정보]

====
+

NOTE: Hyper-V에서 ESXi로 VM을 변환할 때 대상 경로를 적절한 qtree로 설정합니다.



. 선택한 모든 VM에 대한 부팅 순서와 부팅 지연을 구성합니다.
+
** *1*: 전원을 켜는 첫 번째 VM
** *3*: 기본값
** *5*: 마지막으로 전원이 켜진 VM


. *리소스 그룹 만들기*를 클릭합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-365.png[부팅 순서 구성]

====


.결과
리소스 그룹이 생성되어 블루프린트 구성을 위한 준비가 되었습니다.



== 4단계: 마이그레이션 청사진 만들기

플랫폼 매핑, 네트워크 구성, VM 설정을 포함하여 마이그레이션 계획을 정의하는 청사진을 만듭니다.

.단계
. *청사진*으로 이동하여 *새 청사진 만들기*를 클릭합니다.
. 청사진의 이름을 제공하고 호스트 매핑을 구성합니다.
+
** *소스 사이트* 및 관련 Hyper-V 하이퍼바이저를 선택하세요.
** *대상 사이트* 및 관련 vCenter를 선택하세요.
** 호스트 및 클러스터 매핑 구성
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-366.png[블루프린트 호스트 매핑]

====


. 리소스 그룹 세부 정보를 선택하고 *계속*을 클릭합니다.
. 여러 그룹이 있는 경우 리소스 그룹에 대한 실행 순서를 설정합니다.
. 적절한 포트 그룹에 네트워크 매핑을 구성합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-367.png[네트워크 매핑]

====
+

NOTE: VMware에서는 분산 포트 그룹만 지원되는 옵션입니다.  테스트 마이그레이션의 경우, 프로덕션 네트워크 충돌을 피하기 위해 "네트워크를 구성하지 않음"을 선택하세요. 변환 후 네트워크 설정을 수동으로 지정하세요.

+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-368.png[네트워크 구성 옵션]

====
. 스토리지 매핑을 검토합니다(VM 선택에 따라 자동으로 선택됨).
+

NOTE: 필요한 권한이 미리 qtree에 제공되어 있는지 확인하세요.

. 사용자 정의 스크립트나 IP 주소 사용자 정의에 필요한 경우 VM 준비 재정의를 구성합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-369.png[준비 무시]

====
. VM 세부 정보에서 각 OS 유형에 대한 서비스 계정과 자격 증명을 제공합니다.
+
** *Windows*: 로컬 관리자 또는 도메인 자격 증명(VM에 사용자 프로필이 있는지 확인)
** *Linux*: 비밀번호 입력 없이 sudo 권한이 있는 사용자
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-370.png[서비스 계정 자격 증명]

====


. IP 설정 구성:
+
** *구성하지 마세요*: 기본 옵션
** *IP 유지*: 소스 시스템의 동일한 IP 유지
** *DHCP*: 대상 VM에 DHCP를 할당합니다.
+
prepareVM 단계에서 VM의 전원이 켜져 있고 통합 서비스가 활성화되어 있는지 확인하세요.



. VM 설정 구성:
+
** CPU/RAM 매개변수 크기 조정(선택 사항)
** 부팅 순서 및 부팅 지연 수정
** *전원 켜기*: 마이그레이션 후 VM 전원을 켜도록 선택합니다(기본값: 켜짐)
** *VMware 도구 추가*: 변환 후 VMware 도구 설치(기본값: 선택됨)
** *MAC 유지*: 라이선스 요구 사항을 위해 MAC 주소를 유지합니다.
** *서비스 계정 재정의*: 필요한 경우 별도의 서비스 계정을 지정하세요.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-371.png[VM 구성]

====


. *계속*을 클릭하세요.
. (선택 사항) 날짜와 시간을 선택하여 마이그레이션을 예약합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-372.png[이주 일정]

====
+

NOTE: VM 준비 시간을 확보하기 위해 최소 30분 전에 마이그레이션 일정을 예약하세요.

. *청사진 만들기*를 클릭하세요.


.결과
Shift Toolkit은 소스 VM에서 스크립트를 실행하여 마이그레이션을 준비하는 prepareVM 작업을 시작합니다.

.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-373.png[PrepareVM 작업이 시작되었습니다.]

====
준비 과정:

* Windows VM의 경우: 스크립트를 저장합니다. `C:\NetApp`
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-374.png[Windows 준비 스크립트]

====
* Linux VM의 경우: 스크립트를 저장합니다. `/NetApp` 그리고 `/opt`
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-375.png[Linux 준비 스크립트]

====
+

NOTE: CentOS 또는 Red Hat VM의 경우 Shift Toolkit은 디스크 변환 전에 필요한 드라이버를 자동으로 설치하여 변환 후 성공적인 부팅을 보장합니다.



prepareVM이 성공적으로 완료되면 블루프린트 상태가 "활성"으로 업데이트됩니다.

.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-376.png[청사진 활성 상태]

====


== 5단계: 마이그레이션 실행

Hyper-V에서 VMware ESXi로 VM을 변환하기 위한 마이그레이션 워크플로를 트리거합니다.

.시작하기 전에
* 모든 VM은 계획된 유지 관리 일정에 따라 정상적으로 전원이 꺼집니다.
* Shift Toolkit VM은 도메인의 일부입니다.
* CIFS 공유는 적절한 권한으로 구성되었습니다.
* Qtree에는 올바른 보안 스타일이 있습니다.
* 모든 게스트 VM에서 통합 서비스가 활성화됩니다.
* Linux 기반 게스트 VM에서 SSH가 활성화되었습니다.


.단계
. 청사진에서 *마이그레이션*을 클릭합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-377.png[마이그레이션 버튼]

====
. VM이 계속 켜져 있는 경우 정상적인 종료 프롬프트에 응답합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-378.png[종료 확인]

====
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-379.png[마이그레이션 진행 중]

====


.결과
Shift Toolkit은 다음 단계를 수행합니다.

. 소스 VM의 전원을 끕니다.
. 기존 체크포인트를 삭제합니다
. 소스에서 VM 체크포인트를 트리거합니다.
. 디스크 변환 전에 볼륨 스냅샷을 트리거합니다.
. VHDx 파일을 복제하고 VMDK 형식으로 변환합니다.
. 대상 사이트에서 VM 전원을 켭니다.
. 네트워크 설정을 등록합니다
. VMware Tools를 추가하고 IP 주소를 할당합니다.


변환은 몇 초 안에 완료되므로 VM 가동 중지 시간이 최소화됩니다.

.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-380.png[전환 진행 상황]

====
마이그레이션이 완료되면 블루프린트 상태가 "마이그레이션 완료"로 변경됩니다.

.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-381.png[마이그레이션 완료]

====


== 6단계: 마이그레이션 검증

VMware ESXi 호스트에서 VM이 성공적으로 실행되는지 확인합니다.

.단계
. vCenter 또는 ESXi 호스트에 로그인합니다.
. 지정된 ESXi 호스트에서 VM이 실행 중인지 확인합니다.
+
.예를 보여주세요
[%collapsible]
====
image::shift-toolkit-382.png[ESXi에서 실행되는 VM]

====
. VM 연결 및 애플리케이션 기능을 확인합니다.
. (Windows VM만 해당) 필요한 경우 오프라인 디스크를 온라인으로 전환합니다.
+
[listing]
----
Set-StorageSetting -NewDiskPolicy OnlineAll
----
+

NOTE: 변환 후에는 기본 Microsoft Windows SAN 정책(offlineALL)으로 인해 Windows OS의 모든 VM 디스크(OS 디스크 제외)가 오프라인 상태가 됩니다.  이렇게 하면 여러 서버가 LUN에 액세스할 때 데이터 손상을 방지할 수 있습니다.



.결과
Hyper-V에서 VMware ESXi로의 마이그레이션이 완료되었습니다.


NOTE: Shift Toolkit은 마이그레이션 이후 작업을 위해 cron 작업(Linux)과 예약된 작업(Windows)을 사용합니다.  ESXi 호스트에서 VM이 실행된 후에는 SSH 연결이나 이와 동등한 연결이 생성되지 않습니다.
