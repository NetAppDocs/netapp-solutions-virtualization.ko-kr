---
sidebar: sidebar 
permalink: openshift/osv-rosa-overview.html 
keywords: OpenShift, OCP, Trident, NetApp ONTAP, Red Hat OpenShift, OpenShift Virtualization, ROSA, CNV, Container Native Virtualization, Red Hat OpenShift Virtualization 
summary: ROSA의 Red Hat OpenShift 가상화 
---
= ROSA 클러스터에서 FSx for ONTAP 사용하여 Red Hat OpenShift Virtualization 배포
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
ROSA(AWS의 Red Hat OpenShift Service) 클러스터에 대한 기본 StorageClass로 Amazon FSx for NetApp ONTAP 설정합니다.  이 절차에는 볼륨에 FSx ONTAP 스토리지를 활용하는 VM을 만들고, VM에 대해 만들어진 모든 개체를 검토하고, 게스트 자격 증명을 사용하여 VM에 연결하는 작업이 포함됩니다.

또한 게스트 자격 증명을 사용하여 가상 머신에 연결하고 VM을 다시 시작하는 방법도 살펴보겠습니다.  마지막으로, 현재 노드에서 새 노드로 가상 머신의 라이브 마이그레이션을 수행합니다.  VM 재시작과 라이브 마이그레이션 후 디스크 저장소의 내용을 살펴보겠습니다.



== 필수 조건

* link:https://signin.aws.amazon.com/signin?redirect_uri=https://portal.aws.amazon.com/billing/signup/resume&client_id=signup["AWS 계정"]
* link:https://console.redhat.com/["Red Hat 계정"]
* IAM 사용자link:https://www.rosaworkshop.io/rosa/1-account_setup/["적절한 권한이 있는 경우"] ROSA 클러스터를 생성하고 액세스하려면
* link:https://aws.amazon.com/cli/["AWS CLI"]
* link:https://console.redhat.com/openshift/downloads["로사 CLI"]
* link:https://console.redhat.com/openshift/downloads["OpenShift 명령줄 인터페이스"](오케이)
* link:https://docs.aws.amazon.com/eks/latest/userguide/helm.html["Helm 3 문서"]
* link:https://docs.openshift.com/rosa/rosa_hcp/rosa-hcp-sts-creating-a-cluster-quickly.html["HCP ROSA 클러스터"](최소 3개의 베어 메탈 워커 노드 포함)
* link:https://console.redhat.com/openshift/overview["Red Hat OpenShift 웹 콘솔에 액세스"]
* Trident 25.02 이상 위의 Trident 전제 조건은 다음을 참조하세요.link:osv-trident-install.html["Trident 설치 섹션"] 자세한 내용은.
* link:https://docs.redhat.com/en/documentation/openshift_container_platform/4.17/html/virtualization/installing#virt-aws-bm_preparing-cluster-for-virt["ROSA 클러스터에 OpenShift Virtualization 설치"]


Trident 25.02 릴리스부터 ROSA 클러스터(또는 모든 OpenShift 클러스터)의 작업자 노드를 쉽게 준비하여 FSxN 스토리지에서 iSCSI 작업을 수행할 수 있습니다. iSCSI를 위한 워커 노드 준비를 자동화하는 Trident 25.02(또는 이후 버전)를 설치하는 쉬운 방법은 2가지가 있습니다. OpenShift Virtualization을 설치하기 전에 Trident 백엔드, 스토리지 클래스, 볼륨 스냅샷 클래스 객체를 이미 생성하고 기본값으로 설정해야 합니다.  참조할 수 있습니다link:osv-trident-install.html["Trident 설치 섹션"] 자세한 내용은.



== 초기 설정

트라이던트 백엔드, 스토리지 클래스 및 VolumeSnapshotClass를 설정합니다.  참조할 수 있습니다link:osv-trident-install.html["Trident 설치 섹션"] 자세한 내용은.

트라이던트 백엔드 객체를 생성하기 위한 샘플 yaml

[source, yaml]
----
cat tbc.yaml
apiVersion: v1
kind: Secret
metadata:
  name: backend-tbc-ontap-san-secret
type: Opaque
stringData:
  username: fsxadmin
  password: <password for the fsxN filesystem>
---
apiVersion: trident.netapp.io/v1
kind: TridentBackendConfig
metadata:
  name: backend-tbc-ontap-san
spec:
  version: 1
  storageDriverName: ontap-san
  managementLIF: <management lif of fsxN filesystem>
  backendName: backend-tbc-ontap-san
  svm: svm_FSxNForROSAiSCSI
  credentials:
    name: backend-tbc-ontap-san-secret

cat sc.yaml
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: trident-csi
provisioner: csi.trident.netapp.io
parameters:
  backendType: "ontap-san"
  media: "ssd"
  provisioningType: "thin"
  snapshots: "true"
allowVolumeExpansion: true

cat snapshot-class.yaml
apiVersion: snapshot.storage.k8s.io/v1
kind: VolumeSnapshotClass
metadata:
  name: fsx-snapclass
driver: csi.trident.netapp.io
deletionPolicy: Retain

#oc create -f tbc,yaml -n trident
#oc create -f sc.yaml
#oc create -f snapshot-class.yaml
----
OpenShift Virtualization을 설치하기 전에 스토리지 클래스와 볼륨 스냅샷 클래스가 기본값으로 구성되어 있는지 확인하세요.  기본값 설정 방법에 대한 자세한 내용은 다음을 참조하세요.link:osv-trident-install.html["Trident Storage 및 Snapshot Class 섹션을 사용하여 기본값 설정"] 자세한 내용은.



=== **템플릿에서 VM 만들기**

웹 콘솔을 사용하여 템플릿에서 VM을 만듭니다.  AWS 콘솔의 RedHat OpenShiftService에서 가상 머신을 만듭니다.  클러스터에는 VM을 만드는 데 사용할 수 있는 템플릿이 있습니다.  아래 스크린샷에서는 이 목록에서 Fedora VM을 선택합니다.  VM에 이름을 지정한 다음 **가상 머신 사용자 지정**을 클릭합니다.  **디스크** 탭을 선택하고 **디스크 추가**를 클릭합니다.  디스크 이름을 의미 있는 이름으로 변경하고, 스토리지 클래스로 **trident-csi**를 선택했는지 확인하세요.  **저장**을 클릭합니다.  **가상머신 만들기**를 클릭하세요.

몇 분 후 VM이 실행 상태가 됩니다.image:redhat-openshift-ocpv-rosa-003.png["OCP-v 템플릿에서 VM 생성"]

image:redhat-openshift-ocpv-rosa-004.png["OCP-v 템플릿 소스 사용 가능"]

image:redhat-openshift-ocpv-rosa-005.png["OCP-v VM 사용자 정의"]

image:redhat-openshift-ocpv-rosa-006.png["OCP-v 디스크 탭"]

image:redhat-openshift-ocpv-rosa-007.png["OCP-v 디스크 추가"]

image:redhat-openshift-ocpv-rosa-008.png["OCP-v VM 실행 중"]



=== **VM에 대해 생성된 모든 객체를 검토합니다.**

저장 디스크.image:redhat-openshift-ocpv-rosa-009.png["OCP-v 스토리지 디스크"]

VM의 파일 시스템에는 파티션, 파일 시스템 유형 및 마운트 지점이 표시됩니다.image:redhat-openshift-ocpv-rosa-010.png["OCP-v 파일 시스템"]

VM에 대해 2개의 PVC가 생성됩니다. 하나는 부팅 디스크에서 생성되고 다른 하나는 핫 플러그 디스크에서 생성됩니다.image:redhat-openshift-ocpv-rosa-011.png["OCP-v VM PVC"]

부팅 디스크의 PVC는 액세스 모드가 ReadWriteMany이고, 스토리지 클래스가 trident-csi임을 보여줍니다.image:redhat-openshift-ocpv-rosa-012.png["OCP-v VM 부팅 디스크 PVC"]

마찬가지로 핫 플러그 디스크의 PVC는 액세스 모드가 ReadWriteMany이고, 스토리지 클래스가 trident-csi임을 보여줍니다.image:redhat-openshift-ocpv-rosa-013.png["OCP-v VM 핫플러그 디스크 PVC"]

아래 스크린샷에서는 VM의 Pod 상태가 '실행 중'인 것을 볼 수 있습니다.image:redhat-openshift-ocpv-rosa-014.png["OCP-v VM 실행 중"]

여기서는 VM 포드와 연관된 두 개의 볼륨과 해당 볼륨과 연관된 두 개의 PVC를 볼 수 있습니다.image:redhat-openshift-ocpv-rosa-015.png["OCP-v VM PVC 및 PV"]



=== **VM에 연결**

'웹 콘솔 열기' 버튼을 클릭하고 게스트 자격 증명을 사용하여 로그인하세요.image:redhat-openshift-ocpv-rosa-016.png["OCP-v VM 연결"]

image:redhat-openshift-ocpv-rosa-017.png["OCP-v 로그인"]

다음 명령을 실행하세요

[source]
----
$ df (to display information about the disk space usage on a file system).
----
[source]
----
$ dd if=/dev/urandom of=random.dat bs=1M count=10240 (to create a file called random.dat in the home dir and fill it with random data).
----
디스크에는 11GB의 데이터가 들어 있습니다.image:redhat-openshift-ocpv-rosa-018.png["OCP-v VM이 디스크를 채웁니다"]

vi를 사용하여 테스트에 사용할 샘플 텍스트 파일을 만듭니다.image:redhat-openshift-ocpv-rosa-019.png["OCP-v 파일 생성"]

**관련 블로그**

link:https://community.netapp.com/t5/Tech-ONTAP-Blogs/Unlock-Seamless-iSCSI-Storage-Integration-A-Guide-to-FSxN-on-ROSA-Clusters-for/ba-p/459124["원활한 iSCSI 스토리지 통합 잠금 해제: iSCSI용 ROSA 클러스터의 FSxN 가이드"]

link:https://community.netapp.com/t5/Tech-ONTAP-Blogs/Simplifying-Trident-Installation-on-Red-Hat-OpenShift-with-the-New-Certified/ba-p/459710["새로운 인증 Trident Operator를 사용하여 Red Hat OpenShift에서 Trident 설치 간소화"]
