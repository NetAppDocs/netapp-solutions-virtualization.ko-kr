---
sidebar: sidebar 
permalink: vmware/vmw-vcf-viwld-principal-nfs.html 
keywords: netapp, vmware, cloud, foundation, vcf, aff, all-flash, nfs, vvol, vvols, array, ontap tools, otv, sddc 
summary:  
---
= VI 워크로드 도메인의 주요 스토리지로 ONTAP 의 NFS 데이터 저장소 사용
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
이 사용 사례에서는 VMware Cloud Foundation(VCF) Virtual Infrastructure(VI) 워크로드 도메인에 대한 기본 스토리지 솔루션으로 ONTAP 에서 NFS 데이터 저장소를 구성하는 절차를 설명합니다.  이 절차에서는 필요한 구성 요소, 구성 단계 및 배포 프로세스를 요약합니다.



== NFS의 이점

*간단하고 사용 용이성:* NFS는 설정과 관리가 간단하므로 빠르고 쉽게 파일을 공유해야 하는 환경에 매우 적합한 선택입니다.

*확장성:* ONTAP의 아키텍처는 NFS가 효율적으로 확장되어 인프라를 크게 변경하지 않고도 증가하는 데이터 요구 사항을 지원할 수 있도록 해줍니다.

*유연성:* NFS는 광범위한 애플리케이션과 작업 부하를 지원하므로 가상화된 환경을 포함한 다양한 사용 사례에 다양하게 활용할 수 있습니다.

자세한 내용은 vSphere 8에 대한 NFS v3 참조 가이드를 참조하세요.

NetApp 스토리지 시스템에서 파이버 채널을 사용하는 방법에 대한 자세한 내용은 다음을 참조하세요.link:vmw-vvf-overview.html["vSphere 8용 NFS v3 참조 가이드"] .



== 시나리오 개요

이 시나리오에서는 다음과 같은 상위 수준 단계를 다룹니다.

* NFS 트래픽을 위한 논리적 인터페이스(LIF)를 갖춘 스토리지 가상 머신(SVM)을 생성합니다.
* ONTAP 스토리지 가상 머신(SVM)에 대한 네트워킹을 확인하고 NFS 트래픽을 전송하는 논리적 인터페이스(LIF)가 있는지 확인합니다.
* ESXi 호스트가 NFS 볼륨에 액세스할 수 있도록 내보내기 정책을 만듭니다.
* ONTAP 스토리지 시스템에 NFS 볼륨을 생성합니다.
* SDDC Manager에서 NFS 및 vMotion 트래픽을 위한 네트워크 풀을 만듭니다.
* VI 워크로드 도메인에서 사용할 VCF의 커미션 호스트입니다.
* NFS 데이터 저장소를 주 저장소로 사용하여 VCF에 VI 워크로드 도메인을 배포합니다.
* VMware VAAI용 NetApp NFS 플러그인 설치



NOTE: 이 솔루션은 NetApp AFF 및 FAS 포함한 NFS 스토리지를 지원하는 ONTAP 플랫폼에 적용할 수 있습니다.



== 필수 조건

이 시나리오에서는 다음 구성 요소와 구성이 사용됩니다.

* NFS 트래픽을 허용하도록 구성된 스토리지 가상 머신(SVM)이 있는 NetApp AFF 스토리지 시스템입니다.
* NFS 트래픽을 전달하고 SVM과 연관되는 논리적 인터페이스(LIF)가 IP 네트워크에 생성되었습니다.
* VCF 관리 도메인 배포가 완료되었으며 SDDC 관리자 인터페이스에 액세스할 수 있습니다.
* VCF 관리 네트워크에서 통신을 위해 구성된 4개의 ESXi 호스트.
* 이 목적으로 설정된 VLAN 또는 네트워크 세그먼트의 vMotion 및 NFS 스토리지 트래픽을 위해 예약된 IP 주소입니다.



NOTE: VI 워크로드 도메인을 배포할 때 VCF는 NFS 서버에 대한 연결을 검증합니다.  이 작업은 NFS IP 주소와 함께 추가 vmkernel 어댑터를 추가하기 전에 ESXi 호스트의 관리 어댑터를 사용하여 수행됩니다.  따라서 검증을 진행할 수 있도록 1) 관리 네트워크가 NFS 서버로 라우팅 가능한지, 2) 관리 네트워크의 LIF가 NFS 데이터 저장소 볼륨을 호스팅하는 SVM에 추가되었는지 확인해야 합니다.

ONTAP 스토리지 시스템 구성에 대한 정보는 다음을 참조하세요.link:https://docs.netapp.com/us-en/ontap["ONTAP 9 문서"] 센터.

VCF 구성에 대한 정보는 다음을 참조하세요.link:https://techdocs.broadcom.com/us/en/vmware-cis/vcf.html["VMware Cloud Foundation 문서"] .

vSphere 클러스터에서 NFS를 사용하는 방법에 대한 자세한 내용은 다음을 참조하세요.link:vmw-vvf-overview.html["vSphere 8용 NFS v3 참조 가이드"] .

{nbsp}image:vmware-vcf-aff-070.png["NFS 아키텍처 다이어그램"] {nbsp}



== 배포 단계

NFS 데이터 저장소를 주 저장소로 사용하여 VI 워크로드 도메인을 배포하려면 다음 단계를 완료하세요.

.ONTAP SVM에 대한 네트워킹 확인
[%collapsible%open]
====
ONTAP 스토리지 클러스터와 VI 워크로드 도메인 간 NFS 트래픽을 전송할 네트워크에 필요한 논리적 인터페이스가 설정되었는지 확인합니다.

. ONTAP 시스템 관리자의 왼쪽 메뉴에서 *저장소 VM*으로 이동한 다음 NFS 트래픽에 사용할 SVM을 클릭합니다.  *개요* 탭의 *네트워크 IP 인터페이스*에서 *NFS* 오른쪽에 있는 숫자를 클릭합니다.  목록에서 필요한 LIF IP 주소가 나열되어 있는지 확인하세요.
+
image:vmware-vcf-aff-003.png["SVM에 대한 LIF 확인"]



또는 다음 명령을 사용하여 ONTAP CLI에서 SVM과 연관된 LIF를 확인하세요.

[source, cli]
----
network interface show -vserver <SVM_NAME>
----
. ESXi 호스트가 ONTAP NFS 서버와 통신할 수 있는지 확인합니다.  SSH를 통해 ESXi 호스트에 로그인하고 SVM LIF에 ping을 보냅니다.


[source, cli]
----
vmkping <IP Address>
----

NOTE: VI 워크로드 도메인을 배포할 때 VCF는 NFS 서버에 대한 연결을 검증합니다.  이 작업은 NFS IP 주소와 함께 추가 vmkernel 어댑터를 추가하기 전에 ESXi 호스트의 관리 어댑터를 사용하여 수행됩니다.  따라서 검증을 진행할 수 있도록 1) 관리 네트워크가 NFS 서버로 라우팅 가능한지, 2) 관리 네트워크의 LIF가 NFS 데이터 저장소 볼륨을 호스팅하는 SVM에 추가되었는지 확인해야 합니다.

====
.NFS 볼륨 공유를 위한 내보내기 정책 생성
[%collapsible%open]
====
ONTAP System Manager에서 내보내기 정책을 만들어 NFS 볼륨에 대한 액세스 제어를 정의합니다.

. ONTAP 시스템 관리자에서 왼쪽 메뉴의 *스토리지 VM*을 클릭하고 목록에서 SVM을 선택합니다.
. *설정* 탭에서 *내보내기 정책*을 찾아 화살표를 클릭하여 액세스합니다.
+
image:vmware-vcf-aff-006.png["수출 정책 액세스"]

+
{nbsp}

. *새 내보내기 정책* 창에서 정책 이름을 추가하고, *새 규칙 추가* 버튼을 클릭한 다음, *+추가* 버튼을 클릭하여 새 규칙을 추가합니다.
+
image:vmware-vcf-aff-007.png["새로운 수출 정책"]

+
{nbsp}

. 규칙에 포함할 IP 주소, IP 주소 범위 또는 네트워크를 입력하세요.  *SMB/Cifs* 및 * FlexCache* 상자의 선택을 해제하고 아래의 액세스 세부 정보를 선택하세요.  ESXi 호스트에 액세스하려면 UNIX 상자를 선택하는 것으로 충분합니다.
+
image:vmware-vcf-aff-008.png["새 규칙 저장"]

+

NOTE: VI 워크로드 도메인을 배포할 때 VCF는 NFS 서버에 대한 연결을 검증합니다.  이 작업은 NFS IP 주소와 함께 추가 vmkernel 어댑터를 추가하기 전에 ESXi 호스트의 관리 어댑터를 사용하여 수행됩니다.  따라서 검증을 진행하기 위해서는 VCF 관리 네트워크가 수출 정책에 포함되어야 합니다.

. 모든 규칙을 입력한 후 *저장* 버튼을 클릭하여 새 내보내기 정책을 저장합니다.
. 또는 ONTAP CLI에서 내보내기 정책과 규칙을 만들 수 있습니다.  ONTAP 설명서에서 내보내기 정책을 만들고 규칙을 추가하는 단계를 참조하세요.
+
** ONTAP CLI를 사용하여link:https://docs.netapp.com/us-en/ontap/nfs-config/create-export-policy-task.html["수출 정책 만들기"] .
** ONTAP CLI를 사용하여link:https://docs.netapp.com/us-en/ontap/nfs-config/add-rule-export-policy-task.html["내보내기 정책에 규칙 추가"] .




====
.NFS 볼륨 생성
[%collapsible%open]
====
워크로드 도메인 배포에서 데이터 저장소로 사용할 ONTAP 스토리지 시스템에 NFS 볼륨을 만듭니다.

. ONTAP 시스템 관리자의 왼쪽 메뉴에서 *저장소 > 볼륨*으로 이동한 다음 *+추가*를 클릭하여 새 볼륨을 만듭니다.
+
image:vmware-vcf-aff-009.png["새로운 볼륨 추가"]

+
{nbsp}

. 볼륨의 이름을 추가하고, 원하는 용량을 입력하고, 볼륨을 호스팅할 스토리지 VM을 선택합니다.  계속하려면 *추가 옵션*을 클릭하세요.
+
image:vmware-vcf-aff-010.png["볼륨 세부 정보 추가"]

+
{nbsp}

. 액세스 권한에서 VCF 관리 네트워크 또는 IP 주소와 NFS 서버와 NFS 트래픽의 검증에 사용될 NFS 네트워크 IP 주소가 포함된 내보내기 정책을 선택합니다.
+
image:vmware-vcf-aff-011.png["볼륨 세부 정보 추가"]

+
+ {nbsp}

+

NOTE: VI 워크로드 도메인을 배포할 때 VCF는 NFS 서버에 대한 연결을 검증합니다.  이 작업은 NFS IP 주소와 함께 추가 vmkernel 어댑터를 추가하기 전에 ESXi 호스트의 관리 어댑터를 사용하여 수행됩니다.  따라서 검증을 진행할 수 있도록 1) 관리 네트워크가 NFS 서버로 라우팅 가능한지, 2) 관리 네트워크의 LIF가 NFS 데이터 저장소 볼륨을 호스팅하는 SVM에 추가되었는지 확인해야 합니다.

. 또는 ONTAP 볼륨은 ONTAP CLI에서 생성할 수 있습니다.  자세한 내용은 다음을 참조하세요.link:https://docs.netapp.com/us-en/ontap-cli-9141//lun-create.html["lun 생성"] ONTAP 명령 설명서의 명령입니다.


====
.SDDC 관리자에서 네트워크 풀 생성
[%collapsible%open]
====
ESXi 호스트를 시운전하기 전에 SDDC 관리자에서 네트워크 풀을 생성해야 VI 워크로드 도메인에 배포할 준비가 됩니다.  네트워크 풀에는 NFS 서버와 통신하는 데 사용되는 VMkernel 어댑터에 대한 네트워크 정보와 IP 주소 범위가 포함되어야 합니다.

. SDDC 관리자 웹 인터페이스에서 왼쪽 메뉴의 *네트워크 설정*으로 이동한 다음 *+ 네트워크 풀 만들기* 버튼을 클릭합니다.
+
image:vmware-vcf-aff-004.png["네트워크 풀 생성"]

+
{nbsp}

. 네트워크 풀의 이름을 입력하고, NFS에 대한 확인란을 선택한 다음 모든 네트워킹 세부 정보를 입력합니다.  vMotion 네트워크 정보에 대해서도 이 과정을 반복합니다.
+
image:vmware-vcf-aff-005.png["네트워크 풀 구성"]

+
{nbsp}

. *저장* 버튼을 클릭하면 네트워크 풀 생성이 완료됩니다.


====
.위원회 호스트
[%collapsible%open]
====
ESXi 호스트를 워크로드 도메인으로 배포하려면 먼저 SDDC 관리자 인벤토리에 추가해야 합니다.  여기에는 필요한 정보를 제공하고, 검증을 통과하고, 시운전 절차를 시작하는 것이 포함됩니다.

자세한 내용은 다음을 참조하세요.link:https://techdocs.broadcom.com/us/en/vmware-cis/vcf/vcf-5-2-and-earlier/5-2/commission-hosts.html["위원회 호스트"] VCF 관리 가이드에서.

. SDDC 관리자 인터페이스에서 왼쪽 메뉴의 *호스트*로 이동한 다음 *호스트 위임* 버튼을 클릭합니다.
+
image:vmware-vcf-aff-016.png["커미션 호스트 시작"]

+
{nbsp}

. 첫 번째 페이지는 필수 체크리스트입니다.  모든 필수 조건을 다시 한 번 확인하고 모든 확인란을 선택하여 계속 진행하세요.
+
image:vmware-vcf-aff-017.png["필수 조건 확인"]

+
{nbsp}

. *호스트 추가 및 검증* 창에서 *호스트 FQDN*, *스토리지 유형*, 워크로드 도메인에 사용될 vMotion 및 NFS 스토리지 IP 주소가 포함된 *네트워크 풀* 이름, ESXi 호스트에 액세스하기 위한 자격 증명을 입력합니다.  *추가*를 클릭하여 검증할 호스트 그룹에 호스트를 추가합니다.
+
image:vmware-vcf-aff-018.png["호스트 추가 및 검증 창"]

+
{nbsp}

. 검증할 모든 호스트를 추가한 후, *모두 검증* 버튼을 클릭하여 계속 진행하세요.
. 모든 호스트가 검증되었다고 가정하고 계속하려면 *다음*을 클릭하세요.
+
image:vmware-vcf-aff-019.png["모두 검증하고 다음을 클릭하세요"]

+
{nbsp}

. 위임할 호스트 목록을 검토하고 *위임* 버튼을 클릭하여 프로세스를 시작하세요.  SDDC 관리자의 작업 창에서 시운전 프로세스를 모니터링합니다.
+
image:vmware-vcf-aff-020.png["모두 검증하고 다음을 클릭하세요"]



====
.VI 워크로드 도메인 배포
[%collapsible%open]
====
VI 워크로드 도메인 배포는 VCF 클라우드 관리자 인터페이스를 사용하여 수행됩니다.  여기에서는 저장소 구성과 관련된 단계만 설명합니다.

VI 워크로드 도메인 배포에 대한 단계별 지침은 다음을 참조하세요.link:https://techdocs.broadcom.com/us/en/vmware-cis/vcf/vcf-5-2-and-earlier/5-2/map-for-administering-vcf-5-2/working-with-workload-domains-admin/about-virtual-infrastructure-workload-domains-admin/deploy-a-vi-workload-domain-using-the-sddc-manager-ui-admin.html["SDDC 관리자 UI를 사용하여 VI 워크로드 도메인 배포"] .

. SDDC 관리자 대시보드에서 오른쪽 상단 모서리에 있는 *+ 워크로드 도메인*을 클릭하여 새로운 워크로드 도메인을 만듭니다.
+
image:vmware-vcf-aff-012.png["새로운 워크로드 도메인 생성"]

+
{nbsp}

. VI 구성 마법사에서 필요에 따라 *일반 정보*, 클러스터, 컴퓨팅, 네트워킹* 및 *호스트 선택* 섹션을 작성합니다.


VI 구성 마법사에 필요한 정보를 채우는 방법에 대한 정보는 다음을 참조하세요.link:https://techdocs.broadcom.com/us/en/vmware-cis/vcf/vcf-5-2-and-earlier/5-2/map-for-administering-vcf-5-2/working-with-workload-domains-admin/about-virtual-infrastructure-workload-domains-admin/deploy-a-vi-workload-domain-using-the-sddc-manager-ui-admin.html["SDDC 관리자 UI를 사용하여 VI 워크로드 도메인 배포"] .

+image:vmware-vcf-aff-013.png["VI 구성 마법사"]

. NFS 저장소 섹션에서 데이터 저장소 이름, NFS 볼륨의 폴더 마운트 지점, ONTAP NFS 저장소 VM LIF의 IP 주소를 입력합니다.
+
image:vmware-vcf-aff-014.png["NFS 저장소 정보 추가"]

+
{nbsp}

. VI 구성 마법사에서 스위치 구성 및 라이선스 단계를 완료한 다음 *마침*을 클릭하여 워크로드 도메인 생성 프로세스를 시작합니다.
+
image:vmware-vcf-aff-015.png["VI 구성 마법사 완료"]

+
{nbsp}

. 프로세스를 모니터링하고 프로세스 중에 발생하는 모든 검증 문제를 해결합니다.


====
.VMware VAAI용 NetApp NFS 플러그인 설치
[%collapsible%open]
====
VMware VAAI용 NetApp NFS 플러그인은 ESXi 호스트에 설치된 VMware Virtual Disk Libraries를 통합하고 더 빠르게 완료되는 고성능 복제 작업을 제공합니다.  이는 VMware vSphere와 함께 ONTAP 스토리지 시스템을 사용할 때 권장되는 절차입니다.

VMware VAAI용 NetApp NFS 플러그인을 배포하는 방법에 대한 단계별 지침은 다음 지침을 참조하세요.link:https://docs.netapp.com/us-en/nfs-plugin-vmware-vaai/task-install-netapp-nfs-plugin-for-vmware-vaai.html["VMware VAAI용 NetApp NFS 플러그인 설치"] .

====


== 이 솔루션에 대한 비디오 데모

.VCF 워크로드 도메인의 주 스토리지로서의 NFS 데이터 저장소
video::9b66ac8d-d2b1-4ac4-a33c-b16900f67df6[panopto,width=360]


== 추가 정보

ONTAP 스토리지 시스템 구성에 대한 정보는 다음을 참조하세요.link:https://docs.netapp.com/us-en/ontap["ONTAP 9 문서"] 센터.

VCF 구성에 대한 정보는 다음을 참조하세요.link:https://techdocs.broadcom.com/us/en/vmware-cis/vcf.html["VMware Cloud Foundation 문서"] .
